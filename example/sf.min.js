!function t(e,n,s){function o(a,i){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!i&&c)return c(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return o(n?n:t)},l,l.exports,t,e,n,s)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<s.length;a++)o(s[a]);return o}({1:[function(t,e,n){"use strict";var s=t("../helpers/tools"),o=t("../core/Events"),r=t("../helpers/LikeFormData"),a=function(t){this.currentRequests=0,this.events=new o(["beforeSend","load"]),t&&t.headers&&(this.headers=s.extend(this.headers,t.headers))};a.prototype.headers={"X-Requested-With":"XMLHttpRequest"},a.prototype.send=function(t){var e=this;(null===t.data||void 0===t.data||"undefined"===t.data)&&(t.data=null),t.method||(t.method="POST"),t.headers=t.headers?s.extend(this.headers,t.headers):this.headers;var n,o=new Promise(function(s,o){t.url||(console.error("You should provide url"),o("You should provide url")),e.currentRequests++;var a=!1;"undefined"!=typeof window&&window.XDomainRequest&&window.XMLHttpRequest&&void 0===(new XMLHttpRequest).responseType&&0===url.indexOf("http")?(n=new XDomainRequest,a=!0,n.onprogress=function(e){t.onProgress&&t.onProgress(e)}):(n=new XMLHttpRequest,t.onProgress&&n.upload.addEventListener("progress",function(e){e.lengthComputable&&t.onProgress(e.loaded,e.total)},!1)),n.open(t.method,t.url),n.onload=function(){e.currentRequests--;var r=e._parseJSON(n);r.status?r.status>199&&r.status<300?s(r):r.status>399&&r.status<600?o(r):(console.error("unknown status %d. Rejecting",r.status),o(r)):a?s(r):o(r),t.response=r,e.events.trigger("load",t)},n.onerror=function(){e.currentRequests--,o(Error("Network Error"),n)},e.events.trigger("beforeSend",t);var i;null!==t.data?a?i="IEJSON"+JSON.stringify(t.data):(-1!==t.data.toString().indexOf("FormData")?i=t.data:(i=new r(t.data),t.headers["content-type"]=i.getContentTypeHeader()),e._setHeaders(n,t.headers)):i=null;try{n.send(i)}catch(c){n.send(i.toString())}return n});return t.isReturnXHRToo?[o,n]:o},a.prototype.sendRequest=a.prototype.send,a.prototype._setHeaders=function(t,e){for(var n in e)t.setRequestHeader(n,e[n])},a.prototype._parseJSON=function(t){t.response||(t.response=t.responseText);var e={},n=!1;if(t.getResponseHeader&&(n=t.getResponseHeader("Content-Type")),n&&"application/json"!==n.toLowerCase()&&"text/json"!==n.toLowerCase()&&"inode/symlink"!==n.toLowerCase())e={data:t.response};else try{e=JSON.parse(t.response)}catch(s){console.error("Not a JSON!",t.response),e={data:t.response}}return e.status||(e.status=t.status),"string"==typeof e.status&&0===e.status.indexOf("HTTP/")&&e.status.match(/ (\d\d\d)/)&&(e.status=parseInt(e.status.match(/ (\d\d\d)/)[1])),e.statusText||(e.statusText=t.statusText),t.status&&t.status!=e.status&&console.warn("Status from request %d, but response contains status %d",t.status,e.status),e},e.exports=a},{"../core/Events":4,"../helpers/LikeFormData":9,"../helpers/tools":11}],2:[function(t,e,n){"use strict";var s=function(){};s.prototype.init=function(t,e,n){this.sf=t,this.node=e,this.options=Object.assign(this.grabOptions(e),n)},s.prototype.optionsToGrab={},s.prototype.grabOptions=function(t){var e,n,s={};for(var o in this.optionsToGrab)e=null,this.optionsToGrab.hasOwnProperty(o)&&(n=this.optionsToGrab[o],n.hasOwnProperty("value")&&(e=n.value),this.sf.options.instances[this.name]&&this.sf.options.instances[this.name].hasOwnProperty(o)&&(e=this.sf.options.instances[this.name][o]),n.hasOwnProperty("domAttr")&&t.attributes.hasOwnProperty(n.domAttr)&&(e=t.attributes[n.domAttr].value),n.hasOwnProperty("processor")&&(e=n.processor.call(this,t,e,n)),null!==e&&(s[o]=e));return s},s.prototype.getAddon=function(t,e){return this.spiral.instancesController.getInstanceAddon(this.name,t,e)},e.exports=s},{}],3:[function(t,e,n){"use strict";var s=function(t){if(!t)return void console.error("You should provide instancesController  for DOM Mutation. Because DOM Mutation  should known all classes and");if(!this.constructor)return void console.error("Please call DomMutations with new  - 'new DomMutations()' ");this.instancesController=t;var e={attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["class"]},n=this;this.observer=new MutationObserver(function(){n.onDomMutate.apply(n,arguments)}),this.observer.observe(document,e)};s.prototype.onDomMutate=function(t){var e=this.instancesController.getClasses(),n="."+e.join(",.");return 1===n.length?!1:(t.forEach(function(t){switch(t.type){case"attributes":this.processMutationAttributes(t,e);break;case"characterData":break;case"childList":this.processMutationChildList(t.addedNodes,"addInstance",n,e),this.processMutationChildList(t.removedNodes,"removeInstance",n,e);break;case"default":console.error("Something wrong. Contact tech support")}},this),!0)},s.prototype.processMutationAttributes=function(t,e){var n=this,s=t.target.className.split(" "),o=t.oldValue?t.oldValue.split(" "):[],r=s.filter(function(t){return-1===o.indexOf(t)}),a=o.filter(function(t){return-1===s.indexOf(t)}),i=r.filter(function(t){return-1!==e.indexOf(t)}),c=a.filter(function(t){return-1!==e.indexOf(t)});c.forEach(function(e){n.instancesController.removeInstance(n.instancesController.getInstanceNameByCssClass(e),t.target)}),i.forEach(function(e){n.instancesController.addInstance(n.instancesController.getInstanceNameByCssClass(e),t.target)})},s.prototype.processMutationChildList=function(t,e,n,s){function o(t){s.forEach(function(n){t.classList.contains(n)&&r.instancesController[e](r.instancesController.getInstanceNameByCssClass(n),t)})}var r=this;[].forEach.call(t,function(t){return 1!==t.nodeType||"SCRIPT"===t.nodeName||"LINK"===t.nodeName?!1:(o(t),[].forEach.call(t.querySelectorAll(n),o),!0)})},s.prototype.stopObserve=function(){this.observer.disconnect()},e.exports=s},{}],4:[function(t,e,n){"use strict";var s=function(t){this._storage={},this._allowedEvents=t};s.prototype.on=function(t,e){var n=t.replace(/\s{2,}/g," ").split(" ");n.forEach(function(n){return this._allowedEvents&&-1===this._allowedEvents.indexOf(n)?void console.warn("Events. Try to register event %s, but event is not allowed",n):(this._storage.hasOwnProperty(t)||(this._storage[n]=[]),void this._storage[n].push(e))},this)},s.prototype.registerAction=s.prototype.on,s.prototype.off=function(t,e){alert("You try to remove action. This part is incomplete")},s.prototype.trigger=function(t,e){if(this._allowedEvents&&-1===this._allowedEvents.indexOf(t))return void console.warn("Events. Try to trigger event %s, but event is not allowed",t);if(this._storage.hasOwnProperty(t))for(var n=0,s=this._storage[t].length;s>n;n++)this._storage[t][n](e)},s.prototype.performAction=s.prototype.trigger,e.exports=s},{}],5:[function(t,e,n){"use strict";var s=function(t){return this.spiral=t,this.constructor?void(this._storage={instancesConstructors:{cssClasses:{},jsConstructors:{}},addons:{},instances:{}}):void console.error("Please call InstancesController with new  - 'new InstancesController()' ")};s.prototype.registerInstanceType=function(t,e,n){var s=t.prototype.name;if(s||console.error("Instance constructor should have name inside it"),this._storage.instancesConstructors.jsConstructors.hasOwnProperty(s))return void console.error("Instance Constructor for type '%s' already added. Skipping",s);if(e&&(this._storage.instancesConstructors.cssClasses[e]=s),this._storage.instancesConstructors.jsConstructors[s]=t,this._storage.instances[s]=[],!n)for(var o=document.getElementsByClassName(e),r=0,a=o.length;a>r;r++)this.addInstance(s,o[r])},s.prototype.addInstanceType=function(t,e,n){return console.warn("addInstanceType is deprecated. Please use registerInstanceType instead"),this.registerInstanceType(e,n)},s.prototype.addInstance=function(t,e,n){var s=this._storage.instancesConstructors.jsConstructors[t],o=this.getInstance(t,e);if(!s||o)return!1;var r=new s(this.spiral,e,n);return this._storage.instances[t].push({node:e,instance:r}),r},s.prototype.removeInstance=function(t,e){var n,s=this.getInstance(t,e,!0);return s?(s.instance.die(),n=this._storage.instances[t].indexOf(s),-1!==n&&this._storage.instances[t].splice(n,1),!0):!1},s.prototype.getInstance=function(t,e,n){var s=this._storage.instances[t],o=!1;if(!s)return!1;if(e=e instanceof HTMLElement?e:document.getElementById(e),!e)return!1;for(var r=0,a=s.length;a>r;r++)if(s[r].node===e){o=n?s[r]:s[r].instance;break}return o},s.prototype.getInstances=function(t){return this._storage.instances[t]||!1},s.prototype.registerAddon=function(t,e,n,s){return this._storage.addons.hasOwnProperty(e)||(this._storage.addons[e]={}),this._storage.addons[e].hasOwnProperty(n)||(this._storage.addons[e][n]={}),this._storage.addons[e][n].hasOwnProperty(s)?void console.error("The %s addon type %s already registered for instance %s! Skipping registration.",s,n,e):void(this._storage.addons[e][n][s]=t)},s.prototype.getInstanceAddon=function(t,e,n){return this._storage.addons.hasOwnProperty(t)&&this._storage.addons[t].hasOwnProperty(e)&&this._storage.addons[t][e].hasOwnProperty(n)?this._storage.addons[t][e][n]:!1},s.prototype.getClasses=function(){return Object.keys(this._storage.instancesConstructors.cssClasses)},s.prototype.getInstanceNameByCssClass=function(t){return this._storage.instancesConstructors.cssClasses[t]},s.prototype.getInstanceConstructors=function(t){},e.exports=s},{}],6:[function(t,e,n){"use strict";e.exports=function(t){t.ajax.events.on("load",function(e){var n=e.response;if(n.hasOwnProperty("action"))if("string"==typeof n.action)t.events.trigger(n.action);else if("object"==typeof n.action){var s=Object.keys(n.action);if(-1!==s.indexOf("flash")){var o=n.action.flash,r=Date.now(),a={};"object"==typeof n.action.flash?(a=o,a.timestamp=r):a={message:o,timestamp:r},sessionStorage.setItem("sfFlashMessage",JSON.stringify(a))}-1!==s.indexOf("redirect")?setTimeout(function(){t.events.trigger("redirect",n.action.redirect,e)},0|+n.action.delay):-1!==s.indexOf("name")&&setTimeout(function(){t.events.trigger(n.action.name,n.action.url)},+n.action.delay||0)}else console.error("Action from server. Something wrong. ",n.action)}),function(t){if(t){var e,n,s,o=JSON.parse(t),r=Date.now();r-o.timestamp>1e4||(s="debug"===o.type||"success"===o.type?"debug":"info"!==o.type&&o.type&&"notice"!==o.type?"danger":"info",e=document.createElement("div"),n=document.createElement("div"),n.classList.add("flash-wrapper"),e.classList.add("flash",s),e.innerHTML=o.message,document.body.appendChild(n),n.appendChild(e),setTimeout(function(){n.classList.add("show")},1),setTimeout(function(){n.classList.remove("show")},o.timeout||5e3),sessionStorage.removeItem("sfFlashMessage"))}}(sessionStorage.getItem("sfFlashMessage"))}},{}],7:[function(t,e,n){e.exports=function(t){t.on("redirect",function(t){var e="[object String]"===Object.prototype.toString.call(t)?t:t.url;window.location[/^(?:[a-z]+:)?\/\//i.test(e)?"href":"pathname"]=e}),t.on("reload",function(){location.reload()}),t.on("refresh",function(){t.trigger("reload")}),t.on("close",function(){window.close()})}},{}],8:[function(t,e,n){"use strict";var s=function(){this._DOMEventsStorage=[]};s.prototype.add=function(t){"[object Array]"!==Object.prototype.toString.call([])&&(t=[t]),t.forEach(function(t){t.useCapture=!!t.useCapture,t.DOMNode.addEventListener(t.eventType,t.eventFunction,t.useCapture),this._DOMEventsStorage.push(t)},this)},s.prototype.remove=function(t){console.warn("TODO IMPLEMENT")},s.prototype.removeAll=function(){this._DOMEventsStorage.forEach(function(t){t.DOMNode.removeEventListener(t.eventType,t.eventFunction,t.useCapture)}),this._DOMEventsStorage=[]},e.exports=s},{}],9:[function(t,e,n){"use strict";var s=function(t,e){this.data={},t&&("[object Object]"!==Object.prototype.toString.call(t)?console.warn("LikeFormData can't accept non Object. Please reefer to documentation. Problem parameter is:",t):this.data=t),this.boundary=e?e:"SpiralFormData-"+Math.random().toString().substr(2)};s.prototype.append=function(t,e){this.data[t]=e},s.prototype.toString=function(){var t="",e=this.boundary,n=function(s,o){for(var r in s)s.hasOwnProperty(r)&&"undefined"!=typeof s[r]&&("object"==typeof s[r]?n(s[r],0===o.length?r:o+"["+r+"]"):t+="--"+e+"\r\nContent-Disposition: form-data; name="+(0===o.length?r:o+"["+r+"]")+"\r\n\r\n"+s[r]+"\r\n")};return"object"!=typeof this.data&&(this.data={data:this.data}),n(this.data,""),t+="--"+this.boundary+"--\r\n"},s.prototype["delete"]=function(t){return delete this.data[t]},s.prototype.get=function(t){return this.data[t]},s.prototype.getAll=function(){return this.data},s.prototype.has=function(t){return this.data.hasOwnProperty(t)},s.prototype.set=function(t){this.data[key]=t},s.prototype.getContentTypeHeader=function(){return"multipart/form-data; charset=utf-8; boundary="+this.boundary},e.exports=s},{}],10:[function(t,e,n){e.exports={closest:function(t,e){e="string"==typeof e?[e]:e;for(var n,s=e.length,o=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t&&t.parentNode;){for(n=0;s>n;n++)if(o.call(t,e[n]))return t;t=t.parentNode}return!1},closestByClassName:function(t,e){e="string"==typeof e?[e]:e;for(var n,s=e.length;t&&t.parentNode;){for(n=0;s>n;n++){var o=new RegExp("(\\s|^)"+e[n]+"(\\s|$)");if(t.className.match(o))return t}t=t.parentNode}return!1}}},{}],11:[function(t,e,n){"use strict";var s={extend:function(){for(var t,e={},n=0;n<arguments.length;n++)if("[object Object]"===Object.prototype.toString.call(arguments[n]))for(t in arguments[n])e[t]=arguments[n][t];else console.warn("Merging allowed only for objects. Passed value:",arguments[n]);return e}};e.exports=s},{}],12:[function(t,e,n){"use strict";t("./shim/console"),t("./shim/Object.assign");var s;s="undefined"!=typeof sf&&"[object Object]"===Object.prototype.toString.call(sf)?Object.assign(sf,t("./sf")):t("./sf"),s.hasOwnProperty("options")||(s.options={instances:{}}),s.options.hasOwnProperty("instances")||(s.options.instances={}),window.hasOwnProperty("sf")||(window.sf=s),s.instancesController=new s.core.InstancesController(sf),s.domMutation=new s.core.DomMutations(s.instancesController),s.events=new s.core.Events,t("./core/events/baseEvents.js")(s.events),s.ajax=new s.core.Ajax(window.csrfToken?{headers:{"X-CSRF-Token":window.csrfToken}}:null),t("./core/ajax/baseActions.js")(s),s.createModulePrototype=function(){return Object.create(s.modules.core.BaseDOMConstructor.prototype)},s.registerInstanceType=s.instancesController.registerInstanceType.bind(s.instancesController),s.addInstance=s.instancesController.addInstance.bind(s.instancesController),s.removeInstance=s.instancesController.removeInstance.bind(s.instancesController),s.getInstance=s.instancesController.getInstance.bind(s.instancesController),s.getInstances=s.instancesController.getInstances.bind(s.instancesController),s.closest=sf.helpers.domTools.closest,"object"==typeof n&&n&&(e.exports=s)},{"./core/ajax/baseActions.js":6,"./core/events/baseEvents.js":7,"./sf":13,"./shim/Object.assign":14,"./shim/console":15}],13:[function(t,e,n){var s={Ajax:t("./core/Ajax"),BaseDOMConstructor:t("./core/BaseDOMConstructor"),DomMutations:t("./core/DomMutations"),Events:t("./core/Events"),InstancesController:t("./core/InstancesController")},o={DOMEvents:t("./helpers/DOMEvents"),domTools:t("./helpers/domTools"),LikeFormData:t("./helpers/LikeFormData"),tools:t("./helpers/tools")},r={core:s,helpers:o,tools:o.tools,modules:{WILL_BE_DEPRECATED:!0,core:s,helpers:o}};e.exports=r},{"./core/Ajax":1,"./core/BaseDOMConstructor":2,"./core/DomMutations":3,"./core/Events":4,"./core/InstancesController":5,"./helpers/DOMEvents":8,"./helpers/LikeFormData":9,"./helpers/domTools":10,"./helpers/tools":11}],14:[function(t,e,n){"function"!=typeof Object.assign&&!function(){Object.assign=function(t){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(void 0!==s&&null!==s)for(var o in s)s.hasOwnProperty(o)&&(e[o]=s[o])}return e}}()},{}],15:[function(t,e,n){!function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],s=n.length,o=window.console=window.console||{};s--;)t=n[s],o[t]||(o[t]=e)}()},{}]},{},[12]);
//# sourceMappingURL=sf.min.js.map
