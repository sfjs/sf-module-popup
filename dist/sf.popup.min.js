/*!
 * Popup module v.0.0.0
 * https://github.com/sfjs/sf-module-autocomplete/
 * Copyright (c) 2016, Yauheni Yasinau, spiralscout.com
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sf"));else if("function"==typeof define&&define.amd)define(["sf"],t);else{var o=t("object"==typeof exports?require("sf"):e.sf);for(var n in o)("object"==typeof exports?exports:e)[n]=o[n]}}(this,function(e){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=o(1),s=n(r),i=o(2),a=n(i);o(18),s["default"].instancesController.registerInstanceType(a["default"],"js-sf-popup"),e.exports=a["default"]},function(t,o){t.exports=e},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var r=o(3),s=n(r),i=o(1),a=n(i),p=function(e,t,o){this._construct(e,t,o)};p.prototype=a["default"].createModulePrototype(),p.prototype.name="popup",p.prototype._construct=function(e,t,o){this.init(e,t,o),o&&(this.options=(0,s["default"])(this.options,o)),this.data={},this.els={node:t,modal:document.createElement("div"),backdrop:document.createElement("div"),template:document.querySelector(this.options.templateSelector)},this.modalReady=!1,this.pattern=new RegExp("\\"+this.options.delimiters[0]+".*?(?="+this.options.delimiters[1]+")"+this.options.delimiters[1]),this.matches=[],this.options.data||this.options.url||console.warn("No data or URL to fetch data provided"),this.options.templateSelector||console.warn("No template selector provided"),!this.els.template&&this.options.templateSelector&&console.warn("No template found with provided selector"),this.els.modal.classList.add("sf-popup-modal"),this.els.backdrop.classList.add("sf-popup-backdrop"),this.addEventListeners()},p.prototype.optionsToGrab={url:{value:!1,domAttr:"data-url"},responseDataName:{value:"data",domAttr:"data-response-data-name"},delimiters:{value:"{{,}}",domAttr:"data-delimiters",processor:function(e,t){return t.split(",")}},data:{value:!1,domAttr:"data-data",processor:function(e,t,o){if(!t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){console.error("Popup data JSON.parse error: ",n)}return(0,s["default"])(o.value,t)}},templateSelector:{value:!1,domAttr:"data-template"}},p.prototype.deepObjectValue=function(e,t){t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");for(var o=t.split("."),n=0,r=o.length;r>n;++n){var s=o[n];if(!(s in e))return;e=e[s]}return e},p.prototype.parseTemplate=function(){for(var e,t,o=this,n=this.els.template.innerHTML;e=this.pattern.exec(n);)t=e[0].substring(o.options.delimiters[0].length,e[0].length-o.options.delimiters[1].length),this.matches.push(t),n=n.replace(e[0],o.deepObjectValue(o.data,t)||"");this.els.modal.innerHTML=n,this.modalReady=!0,this.openPopup()},p.prototype.generatePopup=function(){this.modalReady?this.openPopup():this.fetchData()},p.prototype.fetchData=function(){var e=this;this.els.template&&(this.options.url?a["default"].ajax.send({url:this.options.url}).then(function(t){(0,s["default"])(e.data,t[e.options.responseDataName],e.options.data),e.parseTemplate()},function(e){return console.warn("Error has occured during fetching data from given URL"),e}):((0,s["default"])(e.data,e.options.data),this.parseTemplate()))},p.prototype.openPopup=function(){var e=this;document.body.appendChild(this.els.modal),document.body.appendChild(this.els.backdrop),setTimeout(function(){e.els.modal.classList.add("visible"),e.els.backdrop.classList.add("visible")},0)},p.prototype.closePopup=function(){var e=this;this.els.modal.classList.remove("visible"),this.els.backdrop.classList.remove("visible"),setTimeout(function(){e.els.modal.parentNode.removeChild(e.els.modal),e.els.backdrop.parentNode.removeChild(e.els.backdrop)},300)},p.prototype.addEventListeners=function(){var e=this;this._generatePopup=function(){e.generatePopup()},this._closePopup=function(){e.closePopup()},this.els.node&&this.els.node.addEventListener("click",this._generatePopup),this.els.backdrop&&this.els.backdrop.addEventListener("click",this._closePopup)},p.prototype.removeEventListeners=function(){this.els.node&&this.els.node.removeEventListener("change",this._generatePopup),this.els.backdrop&&this.els.backdrop.removeEventListener("click",this._closePopup)},p.prototype.die=function(){this.removeEventListeners(),delete this},e.exports=p},function(e,t,o){e.exports={"default":o(4),__esModule:!0}},function(e,t,o){o(5),e.exports=o(8).Object.assign},function(e,t,o){var n=o(6);n(n.S+n.F,"Object",{assign:o(11)})},function(e,t,o){var n=o(7),r=o(8),s=o(9),i="prototype",a=function(e,t,o){var p,u,c,l=e&a.F,f=e&a.G,d=e&a.S,h=e&a.P,m=e&a.B,v=e&a.W,y=f?r:r[t]||(r[t]={}),b=f?n:d?n[t]:(n[t]||{})[i];f&&(o=t);for(p in o)u=!l&&b&&p in b,u&&p in y||(c=u?b[p]:o[p],y[p]=f&&"function"!=typeof b[p]?o[p]:m&&u?s(c,n):v&&b[p]==c?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[i]=e[i],t}(c):h&&"function"==typeof c?s(Function.call,c):c,h&&((y[i]||(y[i]={}))[p]=c))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,e.exports=a},function(e,t){var o=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},function(e,t){var o=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=o)},function(e,t,o){var n=o(10);e.exports=function(e,t,o){if(n(e),void 0===t)return e;switch(o){case 1:return function(o){return e.call(t,o)};case 2:return function(o,n){return e.call(t,o,n)};case 3:return function(o,n,r){return e.call(t,o,n,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,o){var n=o(12),r=o(13),s=o(15);e.exports=o(17)(function(){var e=Object.assign,t={},o={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(e){o[e]=e}),7!=e({},t)[n]||Object.keys(e({},o)).join("")!=r})?function(e,t){for(var o=r(e),i=arguments,a=i.length,p=1,u=n.getKeys,c=n.getSymbols,l=n.isEnum;a>p;)for(var f,d=s(i[p++]),h=c?u(d).concat(c(d)):u(d),m=h.length,v=0;m>v;)l.call(d,f=h[v++])&&(o[f]=d[f]);return o}:Object.assign},function(e,t){var o=Object;e.exports={create:o.create,getProto:o.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:o.getOwnPropertyDescriptor,setDesc:o.defineProperty,setDescs:o.defineProperties,getKeys:o.keys,getNames:o.getOwnPropertyNames,getSymbols:o.getOwnPropertySymbols,each:[].forEach}},function(e,t,o){var n=o(14);e.exports=function(e){return Object(n(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,o){var n=o(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){var o={}.toString;e.exports=function(e){return o.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,o){var n=o(19);"string"==typeof n&&(n=[[e.id,n,""]]);o(21)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,o){t=e.exports=o(20)(),t.push([e.id,".sf-popup-modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background-color:#fff;overflow:auto;z-index:1000;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0;transition:opacity .3s ease;box-shadow:0 16px 28px 0 rgba(0,0,0,.22),0 25px 55px 0 rgba(0,0,0,.21)}.sf-popup-modal.visible{opacity:1;z-index:1001}.sf-popup-backdrop{top:0;left:0;position:fixed;background-color:#000;width:100vw;height:100vh;opacity:0;transition:opacity .3s ease}.sf-popup-backdrop.visible{opacity:.4;z-index:1000}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var o=this[t];o[2]?e.push("@media "+o[2]+"{"+o[1]+"}"):e.push(o[1])}return e.join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},r=0;r<this.length;r++){var s=this[r][0];"number"==typeof s&&(n[s]=!0)}for(r=0;r<t.length;r++){var i=t[r];"number"==typeof i[0]&&n[i[0]]||(o&&!i[2]?i[2]=o:o&&(i[2]="("+i[2]+") and ("+o+")"),e.push(i))}},e}},function(e,t,o){function n(e,t){for(var o=0;o<e.length;o++){var n=e[o],r=d[n.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](n.parts[s]);for(;s<n.parts.length;s++)r.parts.push(u(n.parts[s],t))}else{for(var i=[],s=0;s<n.parts.length;s++)i.push(u(n.parts[s],t));d[n.id]={id:n.id,refs:1,parts:i}}}}function r(e){for(var t=[],o={},n=0;n<e.length;n++){var r=e[n],s=r[0],i=r[1],a=r[2],p=r[3],u={css:i,media:a,sourceMap:p};o[s]?o[s].parts.push(u):t.push(o[s]={id:s,parts:[u]})}return t}function s(e,t){var o=v(),n=g[g.length-1];if("top"===e.insertAt)n?n.nextSibling?o.insertBefore(t,n.nextSibling):o.appendChild(t):o.insertBefore(t,o.firstChild),g.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");o.appendChild(t)}}function i(e){e.parentNode.removeChild(e);var t=g.indexOf(e);t>=0&&g.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",s(e,t),t}function p(e){var t=document.createElement("link");return t.rel="stylesheet",s(e,t),t}function u(e,t){var o,n,r;if(t.singleton){var s=b++;o=y||(y=a(t)),n=c.bind(null,o,s,!1),r=c.bind(null,o,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=p(t),n=f.bind(null,o),r=function(){i(o),o.href&&URL.revokeObjectURL(o.href)}):(o=a(t),n=l.bind(null,o),r=function(){i(o)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}function c(e,t,o,n){var r=o?"":n.css;if(e.styleSheet)e.styleSheet.cssText=x(t,r);else{var s=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(s,i[t]):e.appendChild(s)}}function l(e,t){var o=t.css,n=t.media;t.sourceMap;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}function f(e,t){var o=t.css,n=(t.media,t.sourceMap);n&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var r=new Blob([o],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}var d={},h=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=h(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,b=0,g=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var o=r(e);return n(o,t),function(e){for(var s=[],i=0;i<o.length;i++){var a=o[i],p=d[a.id];p.refs--,s.push(p)}if(e){var u=r(e);n(u,t)}for(var i=0;i<s.length;i++){var p=s[i];if(0===p.refs){for(var c=0;c<p.parts.length;c++)p.parts[c]();delete d[p.id]}}}};var x=function(){var e=[];return function(t,o){return e[t]=o,e.filter(Boolean).join("\n")}}()}])});
//# sourceMappingURL=sf.popup.min.js.map