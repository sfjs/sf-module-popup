/*!
 * Popup module v.0.0.0
 * https://github.com/sfjs/sf-module-autocomplete/
 * Copyright (c) 2016, Yauheni Yasinau, spiralscout.com
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("sf"));else if("function"==typeof define&&define.amd)define(["sf"],t);else{var n=t("object"==typeof exports?require("sf"):e.sf);for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=n(1),s=o(r),i=n(2),a=o(i);n(18),s["default"].instancesController.registerInstanceType(a["default"],"js-sf-popup"),e.exports=a["default"]},function(t,n){t.exports=e},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var r=n(3),s=o(r),i=n(1),a=o(i),p=function(e,t,n){this._construct(e,t,n)};p.prototype=a["default"].createModulePrototype(),p.prototype.name="popup",p.prototype._construct=function(e,t,n){var o=this;this.init(e,t,n),n&&(this.options=(0,s["default"])(this.options,n)),this.els={node:t,modal:document.createElement("div"),backdrop:document.createElement("div"),template:document.querySelector(this.options.templateSelector)},this.pattern=/\${.*?(?=})}/gi,this.matches=[],this.els.template&&this.parseTemplate(),this.matches.forEach(function(e){o.els.template.innerHTML=o.els.template.innerHTML.replace("${"+e+"}",o.deepObjectValue(o.options.data,e))}),this.els.modal.innerHTML=this.els.template.innerHTML,this.options.data||this.options.url||console.warn("No data or URL to fetch data provided"),this.options.templateSelector||console.warn("No template selector provided"),!this.els.template&&this.options.templateSelector&&console.warn("No template found with provided selector"),this.els.modal.classList.add("sf-popup-modal"),this.els.backdrop.classList.add("sf-popup-backdrop"),this.addEventListeners(),this.addModalEventListeners()},p.prototype.deepObjectValue=function(e,t){t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");for(var n=t.split("."),o=0,r=n.length;r>o;++o){var s=n[o];if(!(s in e))return;e=e[s]}return e},p.prototype.optionsToGrab={url:{value:!1,domAttr:"data-url"},data:{value:!1,domAttr:"data-data",processor:function(e,t,n){if(!t)return this.value;if("string"==typeof t)try{t=JSON.parse(t)}catch(o){console.error("Popup data JSON.parse error: ",o)}return(0,s["default"])(n.value,t)}},templateSelector:{value:!1,domAttr:"data-template"}},p.prototype.parseTemplate=function(){for(var e;e=this.pattern.exec(this.els.template.innerHTML);)this.matches.push(e[0].substring(2,e[0].length-1))},p.prototype.generatePopup=function(){this.openPopup()},p.prototype.fetchData=function(){a["default"].ajax.send({url:this.options.url}).then(function(e){},function(e){return e})},p.prototype.openPopup=function(){var e=this;document.body.appendChild(this.els.modal),document.body.appendChild(this.els.backdrop),setTimeout(function(){e.els.modal.classList.add("visible"),e.els.backdrop.classList.add("visible")},0)},p.prototype.closePopup=function(){var e=this;this.els.modal.classList.remove("visible"),this.els.backdrop.classList.remove("visible"),setTimeout(function(){e.els.modal.parentNode.removeChild(e.els.modal),e.els.backdrop.parentNode.removeChild(e.els.backdrop)},300)},p.prototype.addEventListeners=function(){var e=this;this._generatePopup=function(){e.generatePopup()},this.els.node&&this.els.node.addEventListener("click",this._generatePopup)},p.prototype.removeEventListeners=function(){this.els.node&&this.els.node.removeEventListener("change",this._generatePopup)},p.prototype.addModalEventListeners=function(){var e=this;this._closePopup=function(){e.closePopup()},this.els.backdrop.addEventListener("click",this._closePopup)},p.prototype.removeModalEventListeners=function(){this.els.backdrop&&this.els.backdrop.removeEventListener("click",this._closePopup)},p.prototype.die=function(){this.removeEventListeners(),this.removeModalEventListeners(),delete this},e.exports=p},function(e,t,n){e.exports={"default":n(4),__esModule:!0}},function(e,t,n){n(5),e.exports=n(8).Object.assign},function(e,t,n){var o=n(6);o(o.S+o.F,"Object",{assign:n(11)})},function(e,t,n){var o=n(7),r=n(8),s=n(9),i="prototype",a=function(e,t,n){var p,c,u,l=e&a.F,f=e&a.G,d=e&a.S,h=e&a.P,v=e&a.B,m=e&a.W,y=f?r:r[t]||(r[t]={}),b=f?o:d?o[t]:(o[t]||{})[i];f&&(n=t);for(p in n)c=!l&&b&&p in b,c&&p in y||(u=c?b[p]:n[p],y[p]=f&&"function"!=typeof b[p]?n[p]:v&&c?s(u,o):m&&b[p]==u?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[i]=e[i],t}(u):h&&"function"==typeof u?s(Function.call,u):u,h&&((y[i]||(y[i]={}))[p]=u))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,e.exports=a},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){var o=n(10);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,r){return e.call(t,n,o,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var o=n(12),r=n(13),s=n(15);e.exports=n(17)(function(){var e=Object.assign,t={},n={},o=Symbol(),r="abcdefghijklmnopqrst";return t[o]=7,r.split("").forEach(function(e){n[e]=e}),7!=e({},t)[o]||Object.keys(e({},n)).join("")!=r})?function(e,t){for(var n=r(e),i=arguments,a=i.length,p=1,c=o.getKeys,u=o.getSymbols,l=o.isEnum;a>p;)for(var f,d=s(i[p++]),h=u?c(d).concat(u(d)):c(d),v=h.length,m=0;v>m;)l.call(d,f=h[m++])&&(n[f]=d[f]);return n}:Object.assign},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){var o=n(14);e.exports=function(e){return Object(o(e))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var o=n(16);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t,n){var o=n(19);"string"==typeof o&&(o=[[e.id,o,""]]);n(21)(o,{});o.locals&&(e.exports=o.locals)},function(e,t,n){t=e.exports=n(20)(),t.push([e.id,".sf-popup-modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background-color:#fff;overflow:auto;z-index:1000;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0;transition:opacity .3s ease;box-shadow:0 16px 28px 0 rgba(0,0,0,.22),0 25px 55px 0 rgba(0,0,0,.21)}.sf-popup-modal.visible{opacity:1;z-index:1001}.sf-popup-backdrop{top:0;left:0;position:fixed;background-color:#000;width:100vw;height:100vh;opacity:0;transition:opacity .3s ease}.sf-popup-backdrop.visible{opacity:.4;z-index:1000}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var s=this[r][0];"number"==typeof s&&(o[s]=!0)}for(r=0;r<t.length;r++){var i=t[r];"number"==typeof i[0]&&o[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="("+i[2]+") and ("+n+")"),e.push(i))}},e}},function(e,t,n){function o(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=d[o.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](o.parts[s]);for(;s<o.parts.length;s++)r.parts.push(c(o.parts[s],t))}else{for(var i=[],s=0;s<o.parts.length;s++)i.push(c(o.parts[s],t));d[o.id]={id:o.id,refs:1,parts:i}}}}function r(e){for(var t=[],n={},o=0;o<e.length;o++){var r=e[o],s=r[0],i=r[1],a=r[2],p=r[3],c={css:i,media:a,sourceMap:p};n[s]?n[s].parts.push(c):t.push(n[s]={id:s,parts:[c]})}return t}function s(e,t){var n=m(),o=g[g.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),g.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function i(e){e.parentNode.removeChild(e);var t=g.indexOf(e);t>=0&&g.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",s(e,t),t}function p(e){var t=document.createElement("link");return t.rel="stylesheet",s(e,t),t}function c(e,t){var n,o,r;if(t.singleton){var s=b++;n=y||(y=a(t)),o=u.bind(null,n,s,!1),r=u.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=p(t),o=f.bind(null,n),r=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),o=l.bind(null,n),r=function(){i(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}function u(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=x(t,r);else{var s=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(s,i[t]):e.appendChild(s)}}function l(e,t){var n=t.css,o=t.media;t.sourceMap;if(o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function f(e,t){var n=t.css,o=(t.media,t.sourceMap);o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(r),s&&URL.revokeObjectURL(s)}var d={},h=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},v=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=h(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,b=0,g=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=v()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=r(e);return o(n,t),function(e){for(var s=[],i=0;i<n.length;i++){var a=n[i],p=d[a.id];p.refs--,s.push(p)}if(e){var c=r(e);o(c,t)}for(var i=0;i<s.length;i++){var p=s[i];if(0===p.refs){for(var u=0;u<p.parts.length;u++)p.parts[u]();delete d[p.id]}}}};var x=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])});
//# sourceMappingURL=sf.popup.min.js.map